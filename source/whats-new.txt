.. _golang-whats-new:

==========
What's New
==========

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Learn what's new in:

* :ref:`Version 1.10 <version-1.10>`
* :ref:`Version 1.9 <version-1.9>`
* :ref:`Version 1.8 <version-1.8>`
* :ref:`Version 1.7 <version-1.7>`
* :ref:`Version 1.6 <version-1.6>`
* :ref:`Version 1.5 <version-1.5>`
* :ref:`Version 1.4 <version-1.4>`
* :ref:`Version 1.3 <version-1.3>`
* :ref:`Version 1.2 <version-1.2>`

.. _version-1.10.0:
.. _version-1.10:

What's New in 1.10
--------------------

.. important:: Upgrade to Version 1.10.1 or Higher 

  The 1.10.1 Go driver patches a bug that can cause data corruption when 
  rotating :ref:`Data Encryption Keys <csfle-key-architecture>` (DEKs) encrypted 
  with a :ref:`Customer Master Key <csfle-key-architecture>` hosted on Google 
  Cloud Key Management Service or Azure Key Vault.

New features of the 1.10 Go driver release include: 

- Added full support for MongoDB 6.0.
  
- Support for new features related to :ref:`qe-manual-feature-qe`,
  including new options for automatic and manual encryption.

- Support for the new Automatic Encryption Shared Library, which replaces the 
  ``mongocryptd`` process. The shared library requires MongoDB v6.0 Enterprise 
  or later and ``libmongocrypt`` 1.5.0 or later.

- Added :ref:`clustered index <golang-clustered-indexes>` creation support.

- Added a new API and ``ClientEncryption`` entity operations for encryption key 
  management.

- Added a ``Timeout`` client option to set a default context timeout for 
  each operation sent through that client.

- Implemented a patch to default data to either ``primitive.M`` or 
  ``primitive.D`` when decoding empty types.

- Support for encoding atypical map key types for data that can be unmarshalled 
  into a textual representation of itself. 

- Performance optimizations including:
  
  - Improved full document requests for before and after updates in change 
    stream events.

  - Improved PRN and UUID generation 

  - Reduced memory consumption when compressing wire messages.

- Added troubleshooting support for `frequently encountered issues 
  <https://github.com/mongodb/mongo-go-driver/blob/master/docs/common-issues.md>`__


.. _version-1.9:

What's New in 1.9
-------------------

New features of the 1.9 Go driver release include: 

- Improved connection storm mitigation.

- Added ``Custom```` options to aggregate and change stream operations.

- Added a ``Let`` option to most CRUD commands that specifies parameters for use 
  in an aggregate expression context. ``Let`` must be a document that maps 
  parameter names to values that are constant or closed expressions without 
  references to document fields. MongoDB v5.0 or later is required.

- Added new constructor functions that create ``Cursor`` and ``SingleResult`` 
  instances from marshalable and non-nil BSON documents.


.. _version-1.8:

What's New in 1.8
-----------------

New features of the 1.8 Go driver release include: 

- Added full support for MongoDB 5.1.

- Support for KMIP (Key Management Interoperability Protocol) as a KMS 
  provider for client side encryption. 

- Redesigned driver connection pool for low operation ``Context`` timeouts and 
  to reduced connection churn. Behavior changes include: 

  - New connection creation times out at ``connectTimeoutMS``.

  - At most, two new connections can be established at the same time.

- Removed oppressive and unncessarily gendered language in the Go driver 
  documentation, code, tests, and spec tests. 


.. _version-1.7:

What's New in 1.7
-----------------

.. important:: Upgrade to Version 1.7.2 or Higher 

  The 1.7.2 Go driver contains a bug fix for a data race that can occur between 
  creating and checking out connections when ``minPoolSize > 0``. 

New features of the 1.7 Go driver release include:

- Added full support for MongoDB 5.0.

- Support for the :readconcern:`"snapshot"` read concern outside of 
  multi-document transactions for certain read operations.

- Improved ``WriteException`` and ``BulkWriteException`` error messages for
  schema validation via the ``WriteError.Details`` field.


.. _version-1.6:

What's New in 1.6
-----------------

.. important:: Upgrade to Version 1.6.2 or Higher 

  The 1.6.2 Go driver contains a bug fix for a data race that can occur between 
  creating and checking out connections when ``minPoolSize > 0``. 

New features of the 1.6 Go driver release include:

- Added support for the MongoDB Stable API. For more information, see the 
  :ref:`Stable API Guide <golang-stable-api>`.

- Added support for connections to any MongoDB service that runs behind a load 
  balancer. 
  
- Added support for creating time series collections. For more information, see 
  the :ref:`Time Series Collections Guide <golang-time-series>`.

- Added the ``Let`` option on aggregates.


.. _version-1.5:

What's New in 1.5
-----------------

New features of the 1.5 Go driver release include: 

- Added support for Azure and GCP key management services with client-side field 
  level encryption.

- Added a new errors API to detect duplicate key errors, timeouts, and network 
  errors.

- Added server monitoring to monitor changes on a MongoDB deployment. 

- Added errors to prevent unexpected behavior on maps that contain multiple 
  keys being used as a hint option, sort option, or for index creation.


.. _version-1.4:

What's New in 1.4
-----------------

New features of the 1.4 Go driver release include: 

- Added support for stapled and non-stapled OCSP verification.

- Added ``tlsDisableOCSPEndpointCheck=true`` URI option to disable sending HTTP 
  requests if the OCSP responder is not reachable from the driver and there is 
  no stapled response.

- Added context to errors encountered during BSON unmarshalling.

- Added proper ``Unwrap`` functions for various driver error types. 


.. _version-1.3:

What's New in 1.3
-----------------

New features of the 1.3 Go driver release include: 

- Added new ``mgocompat`` package that exports ``Registry``, 
  ``RegistryRespectNilValues``, and a ``RegistryBuilder``.

- Added ``RegisterTypeEncoder`` and ``RegisterHookEncoder``, which replace the 
  deprecated ``RegisterEncoder`` methods. A corresponding change has been made 
  for ``RegisterDecoder``.


.. _version-1.2:

What's New in 1.2
-----------------

New features of the 1.2 Go driver release include: 

- Added support for client-side field level encryption.

- Added support for Zstandard compression.

- Added ``StructCodec`` options to ``mgocompat`` package.

- Added ``StringCodec`` which allows non-string fields to be decoded into a 
  String field in a struct.
  
- Added ``IntCodec``, ``UIntCodec``, ``BoolCodec``, and ``FloatCodec`` to 
  ``mgocompat`` to allow codecs to convert between numbers and booleans.

- Added ``bson.MarshalValue`` function which marshals generic BSON values.
  